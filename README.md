# Observability and Parameter Estimation of a Generic Model for Aggregated Distributed Energy Resources  

Repository accompanying:  

**"Observability and parameter estimation of a generic model for aggregated distributed energy resources"**  
([arXiv link – to be added])  

---

## Overview
This repository provides the MATLAB/Simulink implementation used in our paper on parameter estimation and observability of the **DER_A model**.  

The work demonstrates:  
- A **Lie derivative-based observability analysis** to identify which DER_A parameters are structurally observable from available measurements.  
- A comparison of **voltage + power measurements vs. current-based measurements**, showing that the {V, P, Q} set provides stronger observability.  
- **Extended Kalman Filter (EKF)** and **Unscented Kalman Filter (UKF)** implementations to estimate a reduced set of observable parameters, with validation against an IEEE 34-node test feeder with PV penetration.  
- Reproducible plots comparing **measured, NERC default, and estimated P/Q trajectories**.  

This framework provides a **practical, measurement-driven solution for DER model calibration**, helping ensure that dynamic simulations reflect real inverter-based resource behavior.  

---

## Prerequisites & Installation
Clone the repository:
```bash
git clone https://github.com/GabrielBukunmi/der_a_param_estimation
cd der_a_param_estimation
```

### Requirements
- MATLAB (R2022a or later recommended)  
- Simulink  
- Control System Toolbox  

All scripts are self-contained. No additional dependencies are required.  

---

## Repository Structure
```
├── main.m              # Runs experiments and reproduces paper figures
├── der_a.m             # DER_A implementation and P/Q comparison using parameters obtained from case1
├── der_a2.m             # DER_A implementation using parameters obtained from case 2
├── PLOTSSF.m           # Plotting utility for smooth saturation and deadband functions
│
├── util/               # Helper functions and utilities
├── simulink/           # Testbed (IEEE 34-bus feeder with DERs)
│
├── Case1/              # EKF and UKF parameter estimation (Case 1: Pflag =0, Vtripflag=0 and Freqflag=0)
│   ├── EKF_DER_A_Case1.m
│   ├── UKF_DER_A_Case1.m
│   ├── plot_EKF_UKF_Case1.m
│   └── Case1_utilities/
│
├── Case2/              # EKF and UKF parameter estimation (Case 2: Pflag =1, Vtripflag=0 and Freqflag=1)
│   ├── EKF_Case2.m
│   ├── UKF_Case2.m
│   ├── plot_EKF_UKF_Case2.m
│   └── Case2_utilities/
│
└── observability/      # Observability analysis
    ├── Observability_checks.m
    ├── param_weight_contributions.m
    ├── plotsingularmatrix.m
```

---

## Quickstart
 **Run the main script**  
   ```matlab
   main
   ```
   This will:  
   - Run EKF and UKF estimators  
   - Compare measured, NERC default, and estimated P/Q  
   - Display figures for estimation and observability  

---

## Reproducing Figures
All figures in the paper can be regenerated by running `main.m`.  The simulink file contains the testbed data, by adding additional DERs to the IEEE 34 network, you will generate a different data that can be used for the estimation problem


---

## Citing this Work
If you use this repository, please cite:  

```bibtex
@article{Odunlami2025,
  title={Observability and parameter estimation of a generic model for aggregated distributed energy resources},
  author={Bukunmi G. Odunlami and Marcos Netto},
  journal={preprint, arXiv:XXXX.XXXXX},
  year={2025}
}
```

---

## License
This work is licensed under the MIT License.  
See the [LICENSE](LICENSE) file for more details.  
