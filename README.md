# Observability and parameter estimation of a generic model for aggregated distributed energy resources  

**Repository accompanying:**

"Observability and parameter estimation of a generic model for aggregated distributed energy resources" by Bukunmi Gabriel Odunlami and Marcos Netto ([arXiv link](https://arxiv.org/abs/2510.10892))

---

## Overview
This repository provides the MATLAB/Simulink implementation used in our paper on observability and parameter estimation of the **aggregate distributed energy resources (der_a) model**.  

This work demonstrates:  
- A **Lie derivative-based observability analysis** to identify which der_a parameters are structurally observable from available measurements.  
- A comparison of two different measurement sets, showing that the **{voltage, real power, reactive power} measurement set** provides stronger observability.  
- **Extended Kalman Filter (EKF)** and **Unscented Kalman Filter (UKF)** implementations to estimate a subset of der_a parameters, with validation against an IEEE 34-node test feeder with distributed energy resources.

This framework provides a **practical, measurement-driven solution for calibration of the der_a model**, ensuring that dynamic simulations accurately reflect the collective behavior of inverter-based resources.

---

## Prerequisites & Installation
Clone the repository:
```bash
git clone https://github.com/GabrielBukunmi/der_a_param_estimation
cd der_a_param_estimation
```

### Requirements
- MATLAB (R2022a or later recommended)  
- Simulink  
- Control system toolbox  

All scripts are self-contained. No additional dependencies are required.  

---

## Repository Structure
```
├── main.m              # Runs experiments and reproduces paper figures
├── der_a.m             # der_a implementation and P/Q comparison using parameters obtained from Case 1
├── der_a2.m            # der_a implementation using parameters obtained from Case 2
├── PLOTSSF.m           # Plotting utility for smooth saturation and deadband functions
│
├── util/               # Helper functions and utilities
├── simulink/           # Testbed (IEEE 34-node feeder with distributed energy resources)
│
├── Case1/              # EKF/UKF parameter estimation (Case 1: Pflag =0, Vtripflag=0 and Freqflag=0)
│   ├── EKF_DER_A_Case1.m
│   ├── UKF_DER_A_Case1.m
│   ├── plot_EKF_UKF_Case1.m
│   └── Case1_utilities/
│
├── Case2/              # EKF/UKF parameter estimation (Case 2: Pflag =1, Vtripflag=0 and Freqflag=1)
│   ├── EKF_Case2.m
│   ├── UKF_Case2.m
│   ├── plot_EKF_UKF_Case2.m
│   └── Case2_utilities/
│
└── observability/      # Observability analysis
    ├── Observability_checks.m
    ├── param_weight_contributions.m
    ├── plotsingularmatrix.m
```

---

## Quickstart
 **Run the main script**  
   ```matlab
   main
   ```
   This will:  
   - Run EKF and UKF estimators  
   - Compare results from the calibrated model against those obtained by using NERC default parameter values without calibration
   - Display figures for estimation and observability

---

## Reproducing Figures
All figures in the paper can be regenerated by running `main.m`.  The Simulink file contains the testbed data. By adding additional distributed energy resources to the IEEE 34-node test feeder, a different dataset can be generated for testing.


---

## Citing this Work
If you use this repository, please cite:  

```bibtex
@article{Odunlami2025,
  title={Observability and parameter estimation of a generic model for aggregated distributed energy resources},
  author={Bukunmi G. Odunlami and Marcos Netto},
  journal={preprint, arXiv:2510.10892},
  year={2025}
}
```

---

## License
This work is licensed under the MIT License.  
See the [LICENSE](LICENSE) file for more details.  
